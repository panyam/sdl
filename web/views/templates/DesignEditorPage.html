<!-- templates/DesignEditorPage.html -->
{{# include "BasePage.html" #}}
{{# include "TableOfContents.html" #}}
{{# include "DocumentTitle.html" #}}
{{# include "SectionsList.html" #}}

{{ define "ExtraHeaderButtons" }}
<!-- Save Button -->
<button class="px-3 py-1.5 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded-md transition duration-150 ease-in-out flex items-center">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4" />
    </svg>
    Save
</button>

<!-- Export Button -->
<button class="px-3 py-1.5 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 text-sm font-medium rounded-md transition duration-150 ease-in-out flex items-center">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12" />
    </svg>
    Export
</button>
{{ end }}

{{ define "BodySection" }}
    <input id="designIdInput" value = "{{ .DesignId }}" type="hidden" />
    <!-- Main Content Area -->
    <div class="flex flex-col md:flex-row">
        <!-- Sidebar (fixed on desktop, collapsible on mobile) -->
       <div id="toc-sidebar" class="fixed inset-y-0 left-0 z-40 h-screen w-72 bg-white dark:bg-gray-800 shadow-xl transform -translate-x-full transition-transform duration-300 ease-in-out md:w-64 md:relative md:translate-x-0 md:border-r md:dark:border-gray-700 md:z-10">
           {{ template "TableOfContents" . }}
       </div>

       <!-- Sidebar Backdrop (Mobile Only) -->
       <div id="sidebar-backdrop" class="fixed inset-0 z-30 bg-black dark:bg-gray-900/70 hidden transition-opacity duration-300 ease-in-out opacity-50 backdrop-blur-sm md:hidden"></div>

        <!-- Main content with right padding on desktop to account for sidebar -->
        <main class="flex-1 p-4 md:ml-64">
            <!-- Document Content -->
            <div class="max-w-4xl mx-auto">
                <!-- Document Title Block -->
                <div class="mb-6">
                    <!-- Pass the loaded design data to the DocumentTitle template -->
                    {{ template "DocumentTitle" .Design }}
                </div>

                <!-- Sections Container -->
                <!--<div id="sections-container" class="space-y-6">-->
                <div id="sections-container">
                    <!-- SectionsList template doesn't need data directly anymore, JS populates -->
                    {{ template "SectionsList" . }}
                </div>
            </div>
        </main>
    </div>
{{ end }}

{{ define "PreBodySection" }}
    <!-- Floating Action Button (FAB) for Adding Section -->
    <button id="fab-add-section-btn" title="Add new section to end" aria-label="Add new section to end" class="hidden fixed bottom-20 right-8 z-20 inline-flex items-center justify-center w-14 h-14 bg-blue-600 hover:bg-blue-700 text-white rounded-full shadow-lg transition duration-150 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4" />
        </svg>
     </button>
{{ end }} 

{{ define "PostBodySection" }}
{{# include "gen/DesignEditorPage.html" #}}
{{# include "TemplateRegistry.html" #}}
{{ end }}

{{/* --- IMPORTANT: Modify the BasePage block in DesignEditorPage template --- */}}
{{ define "DesignEditorPage" }}
    {{ template "BasePage" . }}
{{ end }}
